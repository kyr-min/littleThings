<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base Conversion</title>
    <script>

        const createQuestionInfo = (base) => {
            const randNum = createRndNum(1000);
            
            return { num: randNum.toString(base), base };
        }

        const createRndNum = (max, min=0, pnt= 1) => {
            return Math.floor((Math.random() * max +min) * (pnt)) / pnt
        }

        const convert = () => {
            const num = prompt(`number: `);
            const base = parseInt(prompt(`base: `));
            const toBase = parseInt(prompt(`to: `));

            alert(`${num} [${base}] -> \n ${converter(num, base, toBase)} [${toBase}]`)
        }


        const converter = (input, fromBase, toBase) => {
            const numArr = input.split("")
            const intLen = numArr.indexOf(".");
            if(intLen !== -1) numArr.splice(intLen, 1);
            console.log(numArr)
            const numDec = numArr.map((digit) => parseInt(digit, fromBase))
            const numDecSum = numDec.reduce((accumulator, currentValue, i) => {
                return accumulator + currentValue * fromBase ** (-(i-intLen+1));
            }, 0);

            const [intPart, decPart] = numDecSum.toString().split(".");
            const res = reculsiveFunction(intPart, toBase, true) +"."+ reculsiveFunction("0."+decPart, toBase, false)
            return {numDecSum, res}
        }

        const reculsiveFunction = (next, toBase, isInteger) => {
            if(isInteger){
                if((next / toBase) == 0) {return "";}
                return reculsiveFunction(Math.floor(next / toBase), toBase, true) + (next%toBase).toString(toBase);
            } else {
                if(next%1 == 0) return "";
                return  Math.floor(next * toBase).toString(toBase) + reculsiveFunction((next*toBase) %1, toBase,false)
            }
        }

        const createQuestion = () => {
            // const questionInfo = {num: 330, base: 9};
            // const toBase = 10;

            const questionInfo = createQuestionInfo(createRndNum(16, 1));
            const toBase = createRndNum(16,1);

            const ans = converter(questionInfo.num, questionInfo.base, toBase);

            const userAns = prompt(`${questionInfo.num} [${questionInfo.base}]  -> ${toBase}`);
            if (userAns == ans || userAns == ans.toUpperCase) {
                alert("Correct!");
            } else {
                alert(`Wrong! The answer was ${ans}`)
            }
        }
    </script>
</head>

<body>
    <h1 onClick="createQuestion()">Click this to practice base conversion</h1>
    <br/>
    <h1 onClick="convert()">Convert into n-base</h1>
    <!-- 소수 활성화:<input type="checkbox" name="decimalPoint" id="enableDecPnt" onchange="chngDecPntSttng(this)"> -->
</body>

</html>
